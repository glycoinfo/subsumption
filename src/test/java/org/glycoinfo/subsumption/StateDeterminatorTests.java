package org.glycoinfo.subsumption;

import java.io.IOException;

import org.glycoinfo.WURCSFramework.util.WURCSException;
import org.glycoinfo.WURCSFramework.util.WURCSFactory;
import org.glycoinfo.WURCSFramework.wurcs.graph.WURCSGraph;
import org.glycoinfo.subsumption.util.graph.analysis.SubsumptionLevel;
import org.junit.Assert;
import org.junit.Test;

public class StateDeterminatorTests {

	@Test
	public void StateDeterminatortest() throws IOException {		
		int m_WURCSlevel = 0;
		String m_Seq = null;
		WURCSGraph t_inputWURCSGraph = new WURCSGraph();
		WURCSFactory t_inFactory;
		
		// 判定したいWURCSをm_Seqに入れる
		// level 1
		m_Seq = "WURCS=2.0/4,4,3/[o222h][a2112h-1b_1-5_2*NCC/3=O][a2112h-1a_1-5_2*NCC/3=O][a2122h-1a_1-5_2*NCC/3=O]/1-2-3-4/a5-b1_b3-c1_c4-d1";
		// level 2
		//m_Seq = "WURCS=2.0/3,4,3/[o222h][a2112h-1x_1-5_2*NCC/3=O][a2122h-1x_1-5_2*NCC/3=O]/1-2-2-3/a?-b1_b?-c1_c?-d1";
		//m_Seq = "WURCS=2.0/3,4,3/[o222h][a2112h-1x_1-5_2*NCC/3=O][a2122h-1x_1-5_2*NCC/3=O]/1-2-2-3/a?-b1_b?-c1_c?-d1";		
		// level 3
		//m_Seq = "WURCS=2.0/2,4,3/[u2122h_2*NCC/3=O][u2112h]/1-2-1-2/a?|b?|c?|d?}-{a?|b?|c?|d?_a?|b?|c?|d?}-{a?|b?|c?|d?_a?|b?|c?|d?}-{a?|b?|c?|d?";
		//m_Seq = "WURCS=2.0/2,5,4/[u2122h_2*NCC/3=O][u1122h]/1-1-2-2-2/a?|b?|c?|d?|e?}-{a?|b?|c?|d?|e?_a?|b?|c?|d?|e?}-{a?|b?|c?|d?|e?_a?|b?|c?|d?|e?}-{a?|b?|c?|d?|e?_a?|b?|c?|d?|e?}-{a?|b?|c?|d?|e?";

		// level check用
//		m_Seq = "WURCS=2.0/2,4,3/[u2122h_2*NCC/3=O][u2112h]/1-2-1-2/a?|b?|c?|d?}-{a?|b?|c?|d?_a?|b?|c?}-{a?|b?|c?|d?_a?|b?|c?|d?}-{a?|b?|d?";
//		m_Seq = "WURCS=2.0/2,4,3/[u2122h_2*NCC/3=O][u2112h]/1-2-1-2/a?-{b?|c?|d?_a?|b?|c?|d?}-{a?|b?|c?|d?_a?|b?|c?|d?}-{a?|b?|c?|d?";
//		m_Seq = "WURCS=2.0/2,5,4/[u2122h_2*NCC/3=O][u2112h]/1-2-1-2-2/a?|b?|c?|d?|e?}-{a?|b?|c?|d?|e?_a?|b?|c?|d?|e?}-{a?|b?|c?|d?|e?_a?|b?|c?|d?|e?}-{a?|b?|c?|d?|e?_a?|b?|c?|d?|e?}-{a?|b?|c?|d?|e?";
//		m_Seq = "WURCS=2.0/2,6,5/[u2122h_2*NCC/3=O][u2112h]/1-2-1-2-2-2/a?|b?|c?|d?|e?|f1}-{a?|b?|c?|d?|e?|f?_a?|b?|c?|d?|e?|f?}-{a?|b?|c?|d?|e?|f?_a?|b?|c?|d?|e?|f?}-{a?|b?|c?|d?|e?|f?_a?|b?|c?|d?|e?|f?}-{a?|b?|c?|d?|e?|f?_a?|b?|c?|d?|e?|f?}-{a?|b?|c?|d?|e?|f?";
//		// 4という結合情報は残す？
//		m_Seq = "WURCS=2.0/3,7,7/[u2122h_2*NCC/3=O][u1122h][u2112h_2*NCC/3=O_4]/1-1-2-2-1-3-2/a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}*OSO/3=O/3=O";
		m_Seq = "WURCS=2.0/3,7,7/[u2122h_2*NCC/3=O][u1122h][u2112h_2*NCC/3=O]/1-1-1-2-2-2-3/a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}*OSO/3=O/3=O";
		m_Seq = "WURCS=2.0/3,7,7/[u2122h_2*NCC/3=O][u1122h][u2112h_2*NCC/3=O]/1-1-1-2-2-2-3/a?|b?|c?|d?|e?|f?|g?}*OSO/3=O/3=O_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?";
		m_Seq = "WURCS=2.0/3,7,7/[u2122h_2*NCC/3=O][u1122h][u2112h_2*NCC/3=O]/1-1-1-2-2-2-3/";
		m_Seq = "WURCS=2.0/3,4,3/[u2122h_2*NCC/3=O][u2112h_2*NCC/3=O][u222h]/1-2-2-3/a?|b?|c?|d?}-{a?|b?|c?|d?_a?|b?|c?|d?}-{a?|b?|c?|d?_a?|b?|c?|d?}-{a?|b?|c?|d?";
		m_Seq = "WURCS=2.0/3,4,3/[AUd21122h_5*NCCO/3=O][u2122h][u2112h]/1-1-2-3/a?|b?|c?|d?}-{a?|b?|c?|d?_a?|b?|c?|d?}-{a?|b?|c?|d?_a?|b?|c?|d?}-{a?|b?|c?|d?";
		m_Seq = "WURCS=2.0/2,3,2/[a1122h-1x_1-5][a2112h-1x_1-5]/1-2-1/a?-b1_b?-c1*OPO*/3O/3=O";
//		m_Seq = "WURCS=2.0/2,3,2/[u1122h][u2112h]/1-1-2/a?|b?|c?}-{a?|b?|c?_a?|b?|c?}-{a?|b?|c?*OPO*/3O/3=O";
//		m_Seq = "WURCS=2.0/3,7,7/[u2122h_2*NCC/3=O][u1122h][u2112h_2*NCC/3=O]/1-1-1-2-2-2-3/a?|b?|c?|d?|e?|f?|g?}*OSO/3=O/3=O_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?_a?|b?|c?|d?|e?|f?|g?}-{a?|b?|c?|d?|e?|f?|g?";
		m_Seq = "WURCS=2.0/2,10,9/[u2122h_2*NCC/3=O][u1122h]/1-2-2-2-2-2-2-2-2-2/a?|b?|c?|d?|e?|f?|g?|h?|i?|j?}-{a?|b?|c?|d?|e?|f?|g?|h?|i?|j?_a?|b?|c?|d?|e?|f?|g?|h?|i?|j?}-{a?|b?|c?|d?|e?|f?|g?|h?|i?|j?_a?|b?|c?|d?|e?|f?|g?|h?|i?|j?}-{a?|b?|c?|d?|e?|f?|g?|h?|i?|j?_a?|b?|c?|d?|e?|f?|g?|h?|i?|j?}-{a?|b?|c?|d?|e?|f?|g?|h?|i?|j?_a?|b?|c?|d?|e?|f?|g?|h?|i?|j?}-{a?|b?|c?|d?|e?|f?|g?|h?|i?|j?_a?|b?|c?|d?|e?|f?|g?|h?|i?|j?}-{a?|b?|c?|d?|e?|f?|g?|h?|i?|j?*OPO*/3O/3=O_a?|b?|c?|d?|e?|f?|g?|h?|i?|j?}-{a?|b?|c?|d?|e?|f?|g?|h?|i?|j?_a?|b?|c?|d?|e?|f?|g?|h?|i?|j?}-{a?|b?|c?|d?|e?|f?|g?|h?|i?|j?_a?|b?|c?|d?|e?|f?|g?|h?|i?|j?}-{a?|b?|c?|d?|e?|f?|g?|h?|i?|j?*OPO*/3O/3=O";
		m_Seq = "WURCS=2.0/7,8,7/[A3d344xh_2-7][a11221h-1x_1-5][a11221h-1x_1-5_6*OP^XOCCN/3O/3=O][a11221h-1x_1-5_3*OP^XOCCN/3O/3=O][a2122h-1x_1-5][a2112h-1x_1-5][a2122h-1x_1-5_6*OPO/3O/3=O]/1-2-3-4-5-6-7-6/a?-b1_b?-c1_b?-g1_c?-d1_d?-e1_e?-f1_g?-h1";
		
		try {
			t_inFactory = new WURCSFactory(m_Seq);
			t_inputWURCSGraph = t_inFactory.getGraph();
		} catch (WURCSException e) {
			// TODO 自動生成された catch ブロック
			e.printStackTrace();
		}
		
		// Level判定
		WURCSGraphStateDeterminator tStateGet = new WURCSGraphStateDeterminator();
		SubsumptionLevel tLevel = tStateGet.getSubsumptionLevel(t_inputWURCSGraph);	
		m_WURCSlevel = tLevel.getLevel();
		System.out.println("WURCS is: " + m_Seq);
		System.out.println("WURCSlevel is: " + m_WURCSlevel);
	}
}
